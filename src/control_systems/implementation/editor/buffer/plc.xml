<?xml version='1.0' encoding='utf-8'?>
<project xmlns:ns1="http://www.plcopen.org/xml/tc6_0201" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://www.plcopen.org/xml/tc6_0201">
  <fileHeader companyName="Unknown" productName="Unnamed" productVersion="1" creationDateTime="2020-11-13T22:51:02"/>
  <contentHeader name="Unnamed" modificationDateTime="2020-11-14T02:50:23">
    <coordinateInfo>
      <fbd>
        <scaling x="10" y="10"/>
      </fbd>
      <ld>
        <scaling x="10" y="10"/>
      </ld>
      <sfc>
        <scaling x="10" y="10"/>
      </sfc>
    </coordinateInfo>
  </contentHeader>
  <types>
    <dataTypes/>
    <pous>
      <pou name="buffer_stage" pouType="program">
        <interface>
          <localVars>
            <variable name="S_AL1_B" address="%IX100.0">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="P_AL1_B_FT" address="%IX100.1">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="P_AL1_B_BK" address="%IX100.2">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="S_AL1_B1" address="%IX100.3">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="S_AL1_B2" address="%IX100.4">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="S_AL1_B3" address="%IX100.5">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="LP_AL1_CLAMPED" address="%IX100.6">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="S_AL1_LP" address="%IX100.7">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="RUNNING" address="%IX101.0">
              <type>
                <BOOL/>
              </type>
            </variable>
          </localVars>
          <localVars>
            <variable name="timer_1_TB1">
              <type>
                <derived name="TON"/>
              </type>
            </variable>
          </localVars>
          <localVars>
            <variable name="P_AL1_B" address="%QX100.0">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="SB_AL1_B1" address="%QX100.1">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="SB_AL1_B2" address="%QX100.2">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="SB_AL1_B3" address="%QX100.3">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="LP_AL1_CLAMP" address="%QX100.4">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="P_BASE" address="%QX200.0">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB1" address="%QX200.1">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PUSH_B" address="%QX200.2">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB2" address="%QX200.3">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB23" address="%QX200.4">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB3" address="%QX200.5">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB4" address="%QX200.6">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB5" address="%QX200.7">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB6" address="%QX201.0">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB7" address="%QX201.1">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB8" address="%QX201.2">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PB9" address="%QX201.3">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PBF1" address="%QX201.7">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PBF2" address="%QX201.4">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PBF3" address="%QX201.5">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="PBF4" address="%QX201.6">
              <type>
                <BOOL/>
              </type>
            </variable>
            <variable name="STABLE" address="%QX202.0">
              <type>
                <BOOL/>
              </type>
            </variable>
          </localVars>
        </interface>
        <body>
          <ST>
            <xhtml:p><![CDATA[(*Timer*)
timer_1_TB1(IN:= PB1, PT:= T#900ms);

(*If plant is stopped*)
IF NOT RUNNING THEN
  P_BASE:= 1;
  PB1:= 0;
  PUSH_B:= 1;
  PB2:= 0;
  PB23:= 0;
  PB3:= 0;
  PB4:= 0;
  PB5:= 0;
  PB6:= 0;
  PB7:= 0;
  PB8:= 0;
  PB9:=0;
  PBF1:=1;
  PBF2:=1;
  PBF3:=1;
  PBF4:=1;
  
END_IF;

(*============================================================*)
(* TRANSITIONS *)
(*============================================================*)
STABLE:= 0;

WHILE STABLE= 0 DO
  STABLE:= 1;
  
  (*TB0*)
  IF P_BASE AND S_AL1_B AND NOT PB1 THEN
    P_BASE:=0;
    PB1:=1;
    STABLE:=0;
  END_IF;
  
  (*TB1*)
  IF PB1 AND PUSH_B AND timer_1_TB1.Q AND NOT PB2 THEN
    PB1:=0;
    PUSH_B:=0;
    PB2:=1;
  END_IF;
  
  (*TB23*)
  IF PB2 AND P_AL1_B_FT AND NOT PB23 THEN
    PB2:=0;
    PB23:=1;
    STABLE:=0;
  END_IF;
  
  (*TB2*)
  IF PB23 AND P_AL1_B_FT AND NOT PB3 THEN
    PB23:=0;
    PB3:=1;
    STABLE:=0;
  END_IF;
  
  (*TB3*)
  IF PB3 AND P_AL1_B_BK AND NOT PB4 AND NOT PUSH_B AND NOT P_BASE THEN
    PB3:=0;
    PB4:=1;
    PUSH_B:=1;
    P_BASE:=1;
    STABLE:=0;
  END_IF;
  
  (*TB4*)
  IF PB4 AND PBF1 AND S_AL1_B1 AND NOT PB5 THEN 
    PB4:=0;
    PBF1:=0;
    PB5:=1;
    STABLE:=0;
  END_IF;
  
  (*TB5*)
  IF PB5 AND PBF2 AND S_AL1_B2 AND NOT PB6 AND NOT PBF1 THEN
    PB5:=0;
    PBF2:=0;
    PB6:=1;
    PBF1:=1;
    STABLE:=0;
  END_IF; 
  
  (*TB6*)
  IF PB6 AND PBF3 AND S_AL1_B3 AND  NOT PB7 AND NOT PBF2 THEN 
    PB6:=0;
    PBF3:=0;
    PB7:=1;
    PBF2:=1;
    STABLE:=0;
  END_IF;
  
  (*TB7*)
  IF PB7 AND PBF4 AND S_AL1_LP AND NOT PB8 THEN
    PB7:=0;
    PBF4:=0;
    PB8:=1;
    STABLE:=0;
  END_IF;
  
  (*TB8*)
  IF PB8 AND LP_AL1_CLAMPED AND NOT PB9 THEN
    PB8:=0;
    PB9:=1;
    STABLE:=0;
  END_IF;
  
  (*TB9*)
  IF PB9 AND NOT LP_AL1_CLAMPED AND NOT PBF3 AND NOT PBF4 THEN
    PB9:=0;
    PBF3:=1;
    PBF4:=1;
    STABLE:=0;
  END_IF;

    
END_WHILE;
  

(*============================================================*)
(* OUTPUTS *)
(*============================================================*)
(*P_AL1_B*)
IF PB2 OR PB23 THEN 
  P_AL1_B:=1;
END_IF;
IF P_BASE OR PB1 OR PB3 THEN
  P_AL1_B:=0;
END_IF;

(*SB_AL1_B1*)
IF PB5 THEN
  SB_AL1_B1:=1;
END_IF;
IF PBF1 THEN
  SB_AL1_B1:=0;
END_IF;

(*SB_AL1_B2*)
IF PB6 THEN
  SB_AL1_B2:=1;
END_IF;
IF PBF2 THEN 
  SB_AL1_B2:=0;
END_IF;

(*SB_AL1_B3*)
IF PB7 THEN
  SB_AL1_B3:=1;
END_IF;
IF PBF3 THEN
  SB_AL1_B3:=0;
END_IF;

(*LP_AL1_CLAMP*)
IF PB8 OR PB9 THEN
  LP_AL1_CLAMP:=1;
END_IF;
IF PBF4 THEN
  LP_AL1_CLAMP:=0;
END_IF;
  
  
  
  
  
  
  
  ]]></xhtml:p>
          </ST>
        </body>
      </pou>
    </pous>
  </types>
  <instances>
    <configurations>
      <configuration name="Config0">
        <resource name="Res0">
          <task name="task0" priority="0" interval="T#20ms">
            <pouInstance name="instance0" typeName="buffer_stage"/>
          </task>
        </resource>
      </configuration>
    </configurations>
  </instances>
</project>
